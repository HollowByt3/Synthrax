## 1. Global Environment Variables
global(
    environment=[
        "CYBORG_API_KEY=cyborg_API_KEY_HERE",
        "CYBORG_INDEX_KEY=CYBORG_INDEX_KEY",
        "CYBORG_BASE_URI=http://localhost:8000"
    ]
)

# 2. Load Module
module(load="omprog")

# 3. Define the Template Correctly
template(name="CyborgJSON" type="list" option.jsonf="on") {
    property(name="timereported" dateFormat="rfc3339" outname="timestamp" format="jsonf")
    property(name="hostname" outname="hostname" format="jsonf")
    property(name="app-name" outname="app" format="jsonf")
    property(name="syslogseverity-text" outname="severity" format="jsonf")
    property(name="msg" outname="message" format="jsonf")
    # This constant MUST be inside the template block
}

# 4. Filter and Action
if ($programname != 'synthrax') then {
    action(type="omprog"
           binary="/usr/local/bin/synthrax"
           template="CyborgJSON")
}

#This config file creates the structure for our logs and pipes it to the main synthrax program


